generator client {
  provider = "prisma-client-js"
  output   = "./generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("PRISMA_DATABASE_URL")
}

model cittadini {
  email     String    @id @db.VarChar
  password  String    @db.VarChar
  nome      String    @db.VarChar
  cognome   String    @db.VarChar
  residenza Int
  comuni    comuni    @relation(fields: [residenza], references: [istat], onDelete: NoAction, onUpdate: NoAction)
  vetture   vetture[]
}

model comuni {
  istat             Int                @id
  citta             String             @db.VarChar
  provincia         String             @db.VarChar
  regione           String             @db.VarChar
  cittadini         cittadini[]
  comuni_registrati comuni_registrati?
}

model comuni_registrati {
  comune   Int    @id
  email    String @unique @db.VarChar
  password String @db.VarChar
  comuni   comuni @relation(fields: [comune], references: [istat], onDelete: NoAction, onUpdate: NoAction)
  zone     zone[] @ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model rilevazioni {
  id        Int                     @id @default(autoincrement())
  sessione  Int
  punto     Unsupported("geometry")
  punteggio Float                   @db.Real
  sessioni  sessioni                @relation(fields: [sessione], references: [id], onDelete: Cascade)
}

model sessioni {
  id          Int           @id @default(autoincrement())
  vettura     String        @db.Char(17)
  km          Float         @db.Real
  co2         Float         @default(0) @db.Real
  inizio      BigInt        @default(0)
  pm          Float?        @db.Real
  rilevazioni rilevazioni[]
  vetture     vetture       @relation(fields: [vettura], references: [vin], onDelete: Cascade)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model spatial_ref_sys {
  srid      Int     @id
  auth_name String? @db.VarChar(256)
  auth_srid Int?
  srtext    String? @db.VarChar(2048)
  proj4text String? @db.VarChar(2048)
}

model tipologie_zone {
  nome String @id @db.VarChar
  zone zone[] @ignore
}

model vetture {
  proprietario String     @db.VarChar
  vin          String     @id @db.Char(17)
  sessioni     sessioni[]
  cittadini    cittadini  @relation(fields: [proprietario], references: [email], onDelete: Cascade)
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model zone {
  id                Int                     @id @default(autoincrement())
  comune            Int
  tipologia         String                  @default("generica") @db.VarChar
  poligono          Unsupported("geometry")
  comuni_registrati comuni_registrati       @relation(fields: [comune], references: [comune], onDelete: Cascade)
  tipologie_zone    tipologie_zone          @relation(fields: [tipologia], references: [nome], onDelete: NoAction, onUpdate: NoAction)

  @@ignore
}
